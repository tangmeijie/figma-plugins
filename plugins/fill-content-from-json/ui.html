<!DOCTYPE html>
<html>
<head>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      margin: 0;
      padding: 20px;
    }
    
    h2 {
      margin-top: 0;
      margin-bottom: 16px;
      font-size: 16px;
      font-weight: 600;
    }
    
    .container {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }
    
    .file-upload {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    
    #fileStatus {
      font-size: 12px;
      color: #666;
      margin: 4px 0;
    }
    
    button {
      background-color: #18A0FB;
      color: white;
      border: none;
      border-radius: 6px;
      padding: 8px 16px;
      font-weight: 500;
      cursor: pointer;
      transition: background-color 0.2s;
    }
    
    button:hover {
      background-color: #0D8CD9;
    }
    
    button:disabled {
      background-color: #CCCCCC;
      cursor: not-allowed;
    }

    .input-file {
      margin-bottom: 8px;
    }
  </style>
</head>

<body>
  <div class="container">
    <h2>Fill Content from JSON</h2>
    
    <div class="file-upload">
      <label for="jsonFile">选择JSON文件：</label>
      <input type="file" id="jsonFile" accept=".json" class="input-file">
      <div id="fileStatus">未选择文件</div>
    </div>
    
    <button id="fillButton" disabled>填充内容</button>
  </div>

  <script>
    let jsonData = null;
    const fileInput = document.getElementById('jsonFile');
    const fileStatus = document.getElementById('fileStatus');
    const fillButton = document.getElementById('fillButton');
    
    fileInput.onchange = async (event) => {
      const file = event.target.files[0];
      if (file) {
        try {
          const text = await file.text();
          jsonData = JSON.parse(text);
          fileStatus.textContent = `已加载: ${file.name}`;
          fillButton.disabled = false;
        } catch (error) {
          fileStatus.textContent = "JSON解析错误，请检查文件格式";
          fillButton.disabled = true;
          jsonData = null;
        }
      } else {
        fileStatus.textContent = "未选择文件";
        fillButton.disabled = true;
        jsonData = null;
      }
    };
    
    fillButton.onclick = () => {
      if (jsonData) {
        parent.postMessage({ 
          pluginMessage: { 
            type: 'fill-content', 
            jsonData 
          } 
        }, '*');
      }
    };
  </script>
</body>
</html>
